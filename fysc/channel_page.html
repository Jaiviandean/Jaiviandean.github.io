<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FYSC Channel Page</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }
        header {
            background-color: #333;
            color: white;
            padding: 10px 0;
            text-align: center;
        }
        .logo img {
            vertical-align: middle;
        }
        main {
            padding: 20px;
        }
        .section {
            background-color: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 4px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .channel-info {
            background-color: #f4f4f4;
            padding: 20px;
            border-radius: 4px;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        .channel-info h2 {
            margin-top: 0;
        }
        .video-item {
            margin-bottom: 10px;
            padding: 10px;
            background-color: #ddd;
            border-radius: 4px;
        }
        .video-item img {
            width: 100px;
            height: 60px;
            object-fit: cover;
            border-radius: 4px;
            margin-right: 10px;
        }
        .video-item h3 {
            margin-top: 0;
        }
        .btn {
            padding: 8px 16px;
            background-color: #333;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .btn:hover {
            background-color: #555;
        }
    </style>
</head>
<body>
    <header>
        <div class="logo">
            <img src="fysc.png" width="178px" height="38px">
        </div>
    </header>
    <main>
        <div class="section">
            <div class="channel-info">
                <h2 id="channel-name"></h2>
                <p id="channel-description"></p>
                <p>Subscribers: <span id="subscriber-count">0</span></p>
            </div>
            <h2>Your Published Videos</h2>
            <div id="published-video-list"></div>
        </div>
    </main>

    <script>
        let currentUser = null;
        let currentSubscribers = 0;
        let subscriberUpdateInterval;

        function updateUI() {
            const channelName = document.getElementById('channel-name');
            const channelDescription = document.getElementById('channel-description');
            const subscriberCount = document.getElementById('subscriber-count');
            const publishedVideoList = document.getElementById('published-video-list');

            if (currentUser) {
                channelName.textContent = currentUser.channelName;
                channelDescription.textContent = currentUser.channelDescription;
                subscriberCount.textContent = formatNumber(currentSubscribers);
                displayPublishedVideos();
            }
        }

        function displayPublishedVideos() {
            const publishedVideoList = document.getElementById('published-video-list');
            publishedVideoList.innerHTML = '';

            currentUser.videos.forEach((video, index) => {
                const videoItem = document.createElement('div');
                videoItem.classList.add('video-item');
                videoItem.innerHTML = `
                    <img src="${video.thumbnail}" alt="Thumbnail">
                    <h3>${video.title}</h3>
                    <button class="btn" onclick="viewStats(${index})">View Stats</button>
                    <button class="btn" onclick="deleteVideo(${index})">Delete</button>
                `;
                publishedVideoList.appendChild(videoItem);
            });

            // Start subscriber growth based on video views
            startSubscriberGrowth();
        }

        function startSubscriberGrowth() {
            if (subscriberUpdateInterval) {
                clearInterval(subscriberUpdateInterval);
            }

            subscriberUpdateInterval = setInterval(() => {
                let newSubscribers = 0;

                currentUser.videos.forEach(video => {
                    const views = video.stats.views;
                    // Calculate subscribers based on views
                    if (views >= 1000) {
                        newSubscribers += Math.floor(views / 1000);
                    }
                });

                if (newSubscribers > 0) {
                    currentSubscribers += newSubscribers;
                    document.getElementById('subscriber-count').textContent = formatNumber(currentSubscribers);
                }
            }, 10000); // Update every 10 seconds

            // Stop updating after 1 minute (60000 milliseconds)
            setTimeout(() => {
                clearInterval(subscriberUpdateInterval);
            }, 60000);
        }

        function formatNumber(number) {
            return number.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }

        function viewStats(videoIndex) {
            const video = currentUser.videos[videoIndex];
            const statsModal = document.getElementById('viewStatsModal');
            const statsThumbnail = document.getElementById('stats-thumbnail');
            const statsTitle = document.getElementById('stats-title');
            const statsDescription = document.getElementById('stats-description');
            const statsData = document.getElementById('stats-data');

            statsThumbnail.src = video.thumbnail;
            statsTitle.textContent = video.title;
            statsDescription.textContent = video.description;
            statsData.innerHTML = `
                <p>Views: ${video.stats.views}</p>
                <p>Likes: ${video.stats.likes}</p>
                <p>Comments: ${video.stats.comments}</p>
                <p>Shares: ${video.stats.shares}</p>
            `;

            statsModal.style.display = 'block';
        }

        function deleteVideo(videoIndex) {
            currentUser.videos.splice(videoIndex, 1);
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            displayPublishedVideos(); // Refresh the video list after deletion
            startSubscriberGrowth(); // Restart subscriber growth after deletion
        }

        window.onload = function () {
            const storedUser = JSON.parse(localStorage.getItem('currentUser'));
            if (storedUser) {
                currentUser = storedUser;
            }
            updateUI();
        };
    </script>
</body>
</html>
